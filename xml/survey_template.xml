<?xml version='1.0' encoding='utf-8'?>
<survey xmlns:builder="http://decipherinc.com/builder" xmlns:html="http://decipherinc.com/html" xmlns:lucint="http://decipherinc.com/lucint" xmlns:oe_check="http://decipherinc.com/oe_check" xmlns:ss="http://decipherinc.com/ss" alt="[INT] SURVEY TEMPLATE" browserDupes="safe" builder:cname="surveys.tapestryresearch.com" builder:wizardCompleted="1" builderCompatible="1" compat="154" delphi="1" displayOnError="all" extraVariables="source,record,decLang,list,userAgent" fir="on" html:showNumber="0" lang="uk" mobile="compat" mobileDevices="smartphone,tablet,desktop" name="Tapestry Research" secure="1" setup="term,decLang,quota,time" ss:accordionDisplay="0" ss:customCSS="Tapestry_03_08_2023" ss:disableBackButton="1" ss:enableNavigation="0" ss:hideProgressBar="0" ss:listDisplay="1" ss:logoAlt="Logo" ss:logoFile="selfserve/2222/logo_a2a001390fe4dc2ce73e6e195e691697.png" ss:logoPosition="middle" state="testing" theme="company/rebranding-themes">
  <res label="Help">Help</res>
  <res label="Privacy_Policy">Privacy Policy</res>
  <res label="sys_continue" />
  <res label="sys_back" />
  <res label="sys_finish">Finish</res>
  <res label="ProceedText">Click the "&gt;&gt;" button to proceed.</res>
  <res label="PrevText">Previous</res>
  <res label="NextText">Next</res>
  <res label="SP1">Please select one answer only.</res>
  <res label="MP1">Please select all that apply.</res>
  <res label="OE1">Please write your answer in the box below.</res>
  <res label="CS1">Please select one answer for each item.</res>
  <res label="N1">Please enter a number in the box below.</res>
  <res label="less">Please provide a bit more detail</res>
  <res label="enough">This is very good information</res>
  <res label="more">Oh wow! This is great!</res>
  <logic label="Gibberish_Check" oe_check:gibberishThreshold="85" uses="oe_check.2" />
  <style cond="1" name="survey.respview.footer.support">
&lt;div id="footer-logo" style="text-align: center; width: 100%; height: 60px; background-color: #221b4f"&gt;
    &lt;br /&gt;
    &lt;img src="https://uk.focusvision.com/survey/selfserve/2222/250424/Footer.png" style="background-color: #221b4f"
        width="150px" height="38px" /&gt;
&lt;/div&gt;

&lt;div id="footer-links" style="text-align: center; padding-top: 10px;" data-mce-style="text-align: center;"&gt;
    &lt;a href="https://uk.focusvision.com/survey/selfserve/2222/250424/Privacy_Notice_for_research_participants_v1.6.htm"
        target="_blank" rel="noopener"
        data-mce-href="https://uk.focusvision.com/survey/selfserve/2222/250424/Privacy_Notice_for_research_participants_v1.6.htm"
        data-mce-selected="inline-boundary"&gt;${res.Privacy_Policy}&lt;/a&gt;
&lt;/div&gt;
</style>
  <suspend />
  <logic label="ln1" lucint:integration="SHA-1" lucint:integration_key="8f5d308257d34bc580c482868ce6b7cb" uses="lucint.1">
    <title>Cint / Lucid Secure Sample</title>
  </logic>
  <samplesources default="0">
    <samplesource list="134">
      <title>Prodege</title>
      <invalid>You are missing information in the URL. Please verify the URL with the original invite.</invalid>
      <completed>It seems you have already completed this survey.</completed>
      <var name="transaction_id" unique="1" />
      <exit cond="terminated" url="https://pod.prodegemr.com/prodegemr/unsigned-transaction-completion?apik=PAT!HMpwEa8t$I&amp;transaction_id=${transaction_id}&amp;completion_type=3" />
      <exit cond="overquota" url="https://pod.prodegemr.com/prodegemr/unsigned-transaction-completion?apik=PAT!HMpwEa8t$I&amp;transaction_id=${transaction_id}&amp;completion_type=2" />
      <exit cond="qualified" url="https://pod.prodegemr.com/prodegemr/unsigned-transaction-completion?apik=PAT!HMpwEa8t$I&amp;transaction_id=${transaction_id}&amp;completion_type=1" />
    </samplesource>
    <samplesource keyring="sys/dynata" list="101" sign="out,in">
      <title>Dynata</title>
      <invalid>You are missing information in the URL. Please verify the URL with the original invite.</invalid>
      <completed>It seems you have already entered this survey.</completed>
      <var name="psid" unique="1" />
      <exit cond="terminated" url="https://dkr1.ssisurveys.com/projects/end?rst=2&amp;psid=${psid}&amp;_d=${gv.survey.path}" />
      <exit cond="overquota" url="https://dkr1.ssisurveys.com/projects/end?rst=3&amp;psid=${psid}&amp;_d=${gv.survey.path}" />
      <exit cond="qualified" url="https://dkr1.ssisurveys.com/projects/end?rst=1&amp;psid=${psid}&amp;_d=${gv.survey.path}" />
    </samplesource>
    <samplesource keyring="sys/ps" list="127" sign="out,in">
      <title>Pure Spectrum</title>
      <invalid>You are missing information in the URL. Please verify the URL with the original invite.</invalid>
      <completed>It seems you have already entered this survey.</completed>
      <var name="transaction_id" unique="1" />
      <var name="supplier_id" />
      <var name="PSID" />
      <exit cond="terminated" url="https://spectrumsurveys.com/surveydone?st=18&amp;transaction_id=${transaction_id}" />
      <exit cond="overquota" url="https://spectrumsurveys.com/surveydone?st=17&amp;transaction_id=${transaction_id}" />
      <exit cond="qualified" url="https://spectrumsurveys.com/surveydone?st=21&amp;transaction_id=${transaction_id}" />
    </samplesource>
    <samplesource keyring="everyone-sez" list="182" sign="out,in">
      <title>EveryoneSez</title>
      <invalid>You are missing information in the URL. Please verify the URL with the original invite.</invalid>
      <completed>It seems you have already entered this survey.</completed>
      <var name="rid" unique="1" />
      <var name="co" />
      <var name="boost" required="1" values="0,1" />
      <exit cond="terminated" url="https://router.everyonesez.com/redirect_in.php?mp=100&amp;dest=8&amp;rs=t&amp;pid=${rid}&amp;l=${int(preciseTimeSpent())/60}">Thank you for taking our survey.</exit>
      <exit cond="qualified" url="https://router.everyonesez.com/redirect_in.php?mp=100&amp;dest=8&amp;rs=c&amp;pid=${rid}&amp;c=1.25&amp;l=${int(preciseTimeSpent())/60}">Thank you for taking our survey. Your efforts are greatly appreciated!</exit>
      <exit cond="overquota" url="https://router.everyonesez.com/redirect_in.php?mp=100&amp;dest=8&amp;rs=oq&amp;pid=${rid}&amp;l=${int(preciseTimeSpent())/60}">Thank you for taking our survey.</exit>
    </samplesource>
    <samplesource list="139">
      <title>Lucid SHA-1</title>
      <invalid>You are missing information in the URL. Please verify the URL with the original invite.</invalid>
      <completed>It seems you have already entered this survey.</completed>
      <var name="RID" unique="1" />
      <var name="boost" required="1" values="0,1" />
      <exit cond="qualified" url="https://www.samplicio.us/s/ClientCallBack.aspx?RIS=10&amp;RID=${RID}&amp;hash=${p.url_hash}" />
      <exit cond="terminated and hasMarker('QCFailed')" url="https://samplicio.us/s/ClientCallBack.aspx?RIS=30&amp;RID=${RID}" />
      <exit cond="terminated" url="https://www.samplicio.us/s/ClientCallBack.aspx?RIS=20&amp;RID=${RID}" />
      <exit cond="overquota" url="https://www.samplicio.us/s/ClientCallBack.aspx?RIS=40&amp;RID=${RID}" />
    </samplesource>
    <samplesource list="0">
      <title>Open Survey</title>
      <invalid>You are missing information in the URL. Please verify the URL with the original invite.</invalid>
      <completed>It seems you have already entered this survey.</completed>
      <var name="co" />
      <var name="boost" required="1" values="0,1" />
      <exit cond="terminated">Thank you for taking our survey.</exit>
      <exit cond="qualified">Thank you for taking our survey. Your efforts are greatly appreciated!</exit>
      <exit cond="overquota">Thank you for taking our survey.</exit>
    </samplesource>
  </samplesources>
  <suspend />
  <exec when="init">
# SINGLE: clearQ(QUESTION_ID, "sp")
# MULTI: clearQ(QUESTION_ID, "mp")
def clearQ(qid, t):
    if t == "sp":
        qid.val = None
    elif t == "mp":
        for eachRow in qid.rows:
            eachRow.val = None

# USAGE: set_grid_from_loop(TEST_RADIO_[loopvar: label], TEST_RADIO_GRID, "sp")
# USAGE: set_grid_from_loop(TEST_CHECKBOX_[loopvar: label], TEST_CHECKBOX_GRID, "mp")
def set_grid_from_loop(from_q, to_q, q_type):
	for eachRow in from_q.rows:
		if eachRow:
			if q_type == "sp":
				to_q.attr('[loopvar: label]').val = eachRow.index
			elif q_type == "mp":
				to_q.attr('[loopvar: label]').attr(eachRow.label).val = 1


# USAGE: group_rows(QUESTION_ID, ['ROW_1', 'ROW_2'])
def group_rows(question, grouped_rows):
    first_item_index = None
    shuffle_order = [row.index for row in question.rows.order]

    for index, row in enumerate(shuffle_order):
        if question.rows[row].label in grouped_rows:
            if first_item_index == None:
                first_item_index = index
            else:
                first_item_index += 1
                shuffle_order.insert(
                    first_item_index, shuffle_order.pop(index))

    question.rows.order = shuffle_order



# USAGE: group_rows_with_order(QUESTION_ID, ['ROW_1', 'ROW_2'])
def group_rows_with_order(question, grouped_rows):
    current_order = [row.index for row in question.rows.order]
    new_order = []

    grouped_rows = [question.attr(row).index for row in grouped_rows]
    first_item_index = current_order.index(grouped_rows[0])

    current_order.insert(first_item_index, grouped_rows)

    for row in current_order:
        if row == grouped_rows:
            new_order = new_order + row
        elif row not in grouped_rows:
            new_order.append(row)

    question.rows.order = new_order



# USAGE: group_cols(QUESTION_ID, ['CODE_1', 'CODE_2'])
def group_cols(question, grouped_cols):
    first_item_index = None
    shuffle_order = [col.index for col in question.cols.order]

    for index, col in enumerate(shuffle_order):
        if question.cols[col].label in grouped_cols:
            if first_item_index == None:
                first_item_index = index
            else:
                first_item_index += 1
                shuffle_order.insert(
                    first_item_index, shuffle_order.pop(index))

    question.cols.order = shuffle_order


# USAGE: group_cols_with_order(QUESTION_ID, ['COL_1', 'COL_2'])
def group_cols_with_order(question, grouped_cols):
    current_order = [col.index for col in question.cols.order]
    new_order = []

    grouped_cols = [question.attr(col).index for col in grouped_cols]
    first_item_index = current_order.index(grouped_cols[0])

    current_order.insert(first_item_index, grouped_cols)

    for col in current_order:
        if col == grouped_cols:
            new_order = new_order + col
        elif col not in grouped_cols:
            new_order.append(col)

    question.cols.order = new_order


def shuffle_by( current_question, source_question ):
    current_order = [row.text for row in current_question.rows]
    current_question.rows.order = [current_order.index(row.text) for row in source_question.rows.order if row.text in current_order]


def sequential(qid):
	r = True
	p = [item.ival for item in qid]
	for i in range(0, len(p)-1):
		if(len(p[i]) == 0 and len(p[i+1]) gt 0):
			r = False
			break
	return r			

def unique(qid):
	r = True
	p = [item.ival for item in qid if item]
	for i in p:
		if p.count(i) gt 1 and (i.lower()) != "none":
			r = False
			break
	return r

def reverse_code_order(qid, type):
	if type == "cols":
		order = [eachCol.index for eachCol in qid.cols]
		order.reverse()
		qid.cols.order = order
	elif type == "rows":
		order = [eachRow.index for eachRow in qid.rows]
		order.reverse()
		qid.rows.order = order

def question_to_bullets(qid):
	my_list = ["&lt;ul&gt;"]
	for eachRow in qid.rows:
		if eachRow:
			try:
				rowText = eachRow.open
			except:
  				rowText = eachRow.text
  				
			my_list.append("&lt;li style='font-size: 20px;'&gt;"+ rowText+"&lt;/li&gt;")

	final_list = ''.join(my_list) + "&lt;/ul&gt;"
	return final_list

def keep_at_end_of_group(question, target_group, code_label):
    all_indices = [eachRow.index for eachRow in question.rows.order]
    target_group_order = [eachRow.index for eachRow in question.rows.order if eachRow.label in target_group]
    index_to_move = question.attr(code_label).index
    if index_to_move in all_indices:
        # Remove the number to move from the list
        all_indices.remove(index_to_move)

        sequence_index = -1
        for i in range(len(target_group_order) - 1, -1, -1):
            if target_group_order[i] in all_indices:
                sequence_index = all_indices.index(target_group_order[i])
                break
        
        # If a number from the sequence is found in the list, insert after it
        if sequence_index != -1:
            all_indices.insert(sequence_index + 1, index_to_move)
        else:  # If none of the sequence numbers are in the list, append the number
            all_indices.append(index_to_move)
    question.rows.order = all_indices
</exec>
  <style name="respview.client.css">
&lt;style type="text/css"&gt;

/* ******** LOGO STYLING ******** */
.logo-img {
    height: 90px;
    width: 90px;
    object-fit: scale-down;
}

.logo-img-smaller {
    height: 80px;
    width: 80px;
    object-fit: scale-down;
}

.logo-img-larger {
    height: 100px;
    width: 100px;
    object-fit: scale-down;
}

.logo-with-label {
    text-align: center;
}

   &lt;/style&gt;
</style>
  <note>*************** USE (OR DELETE) THE BELOW AS NECESSARY FOR EACH PROJECT ********************</note>
  <radio label="DUM_boost" where="execute,survey,report">
    <title>Sampling type</title>
    <comment>${res.SP1}</comment>
    <exec>
DUM_boost.val = int(boost)
  </exec>
    <row label="r1">Nat Rep</row>
    <row label="r2">Boost</row>
  </radio>
  <radio label="DUM_COUNTRY" cond="not (co in ['',None])" where="execute,survey,report">
    <title>Demography: Country</title>
    <comment>${res.SP1}</comment>
    <exec>
for eachRow in DUM_COUNTRY.rows:
	if eachRow.label == 'r' + str(co):
		DUM_COUNTRY.val = eachRow.index
  </exec>
    <row label="r36" alt="Australia" value="36">Australia</row>
    <row label="r56" alt="Belgium" value="56">Belgium</row>
    <row label="r76" alt="Brazil" value="76">Brazil</row>
    <row label="r156" alt="China" value="156">China</row>
    <row label="r170" alt="Colombia" value="170">Colombia</row>
    <row label="r250" alt="France" value="250">France</row>
    <row label="r276" alt="Germany" value="276">Germany</row>
    <row label="r348" alt="Hungary" value="348">Hungary</row>
    <row label="r360" alt="Indonesia" value="360">Indonesia</row>
    <row label="r380" alt="Italy" value="380">Italy</row>
    <row label="r458" alt="Malaysia" value="458">Malaysia</row>
    <row label="r484" alt="Mexico" value="484">Mexico</row>
    <row label="r528" alt="Netherlands" value="528">Netherlands</row>
    <row label="r608" alt="Philippines" value="608">Philippines</row>
    <row label="r616" alt="Poland" value="616">Poland</row>
    <row label="r643" alt="Russian Federation (the)" value="643">Russian Federation (the)</row>
    <row label="r702" alt="Singapore" value="702">Singapore</row>
    <row label="r710" alt="South Africa" value="710">South Africa</row>
    <row label="r724" alt="Spain" value="724">Spain</row>
    <row label="r752" alt="Sweden" value="752">Sweden</row>
    <row label="r792" alt="Turkey" value="792">Turkey</row>
    <row label="r826" alt="UK" value="826">UK</row>
    <row label="r840" alt="USA" value="840">USA</row>
    <row label="r124" alt="Canada" value="124">Canada</row>
    <row label="r784" alt="United Arab Emirates (the)" value="784">United Arab Emirates (the)</row>
    <row label="r620" alt="Portugal" value="620">Portugal</row>
    <row label="r410" alt="Korea (the Republic of)" value="410">Korea (the Republic of)</row>
    <row label="r682" alt="Saudi Arabia" value="682">Saudi Arabia</row>
    <row label="r818" alt="Egypt" value="818">Egypt</row>
  </radio>
  <suspend />
</survey>